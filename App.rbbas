#tag ClassProtected Class AppInherits ConsoleApplication	#tag Event		Function Run(args() as String) As Integer		  Dim i,j,keyLen,memLen As Integer		  Dim keyMaterial,mb As MemoryBlock		  Dim k As String		  Dim t1 As Double		  		  r=new Random		  keyLen=256		  memLen=keyLen\4		  keyMaterial=NewMemoryBlock(memLen)		  j=keyLen\8 // 8 bits per byte --> "real" length of the key		  		  StdOut.Write "Generating "+Str(keyLen)+"-bit Key --> "		  t1=Microseconds		  mb=NewMemoryBlock(j)		  // Create a random key		  for i=1 to j		    mb.Byte(i-1)=r.InRange(0,255)		  next		  // Transform that key as required for the rijndael lib		  // each half byte is encoded in ASCII-Hexadecimal		  // 0x09 ==> 0x39 etc		  keyMaterial=ComputeKeyMaterial(mb)		  t1=Microseconds-t1		  stdout.WriteLine Format(t1,"###,###")+"µs"		  		  j=UBound(args)		  if j<2 Then		    k="Je ne sais pas ce que je veux..."		  else		    k=args(1)		  end if		  		  stdout.WriteLine "Clear text to encrypt:"		  stdout.WriteLine "  "+k		  t1=Microseconds		  mb=AES_ENCRYPT(keyMaterial,k)		  Dim fp As FolderItem=GetFolderItem("").Parent.Child("encrypted.bin")		  Dim bs As BinaryStream=fp.CreateBinaryFile("any")		  bs.Write(mb.StringValue(0, mb.Size))		  bs=Nil		  Print mb.ToHexadecimal()		  		  t1=Microseconds-t1		  stdout.WriteLine "Encryption: "+Format(t1,"###,###")+"µs"		  if mb=Nil Then		    stdout.WriteLine " "		    stdout.WriteLine " MemoryBlock came back as Nil from AES_ENCRYPT!"		    stdout.WriteLine " I'll go in a corner and die quietly!"		    Quit		  End if		  		  t1=Microseconds		  mb=AES_DECRYPT(keyMaterial,mb)		  t1=Microseconds-t1		  stdout.WriteLine "Decryption: "+Format(t1,"###,###")+"µs"		  		  if mb=Nil Then		    stdout.WriteLine " "		    stdout.WriteLine " MemoryBlock came back as Nil from AES_DECRYPT!"		    stdout.WriteLine " I'll go in a corner and die quietly!"		    Quit		  End if		  		  stdout.WriteLine "Decrypted:"		  stdout.WriteLine "  "+mb.CString(0)		  		End Function	#tag EndEvent	#tag Event		Function UnhandledException(error As RuntimeException) As Boolean		  print error.Message		  print "!!!"		  		End Function	#tag EndEvent	#tag Property, Flags = &h0		r As Random	#tag EndProperty	#tag ViewBehavior	#tag EndViewBehaviorEnd Class#tag EndClass